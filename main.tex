\documentclass[11pt]{article}
\usepackage{ctex}

\newcommand\xor{\oplus}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand\p{\pause}
\newcommand\s{\section}
\newcommand\subs{\subsection}
\newcommand\be{\begin}
\newcommand\en{\end}
% \newcommand\todo{\ \\\textcolor{red}{\textbf{TODO:}} }


% Important!!!
\title{\huge \heiti 简易版题目}



\date{\today}
\author{张若天}

\be{document}

\maketitle



\leftline{编译开关}
% 开不开O2呢

开不开O2呢？


\thispagestyle{empty}



\newpage

\noindent{\emph{浮生有梦三千场\\
穷尽千里诗酒荒\\
徒把理想倾倒\\
不如早还乡\\
~\\
温一壶风尘的酒\\
独饮往事迢迢\\
举杯轻思量\\
泪如潮 青丝留他方\\
}}

\rightline{\emph{--- 乌糟兽/愚青《旧词》}}





\newpage


\s*{待定} %

\emph{tree.in/.out/.cpp}

\emph{3s/512MB}

\subs*{【问题描述】}

给定一棵$n$个点的有根树，节点标号$1\sim n$，$1$号节点为根。

给定$Q$个询问，每次询问给定$x,y$。

求$$\sum_{i \le x}{depth(lca(i,y))^k}$$

$lca(x,y)$表示节点$x$与节点$y$在有根树的最近公共祖先。

$depth(x)$表示$x$节点的深度，根节点的深度为$1$。

由于答案可能很大，所以请输出答案模$998244353$的结果。

\subs*{【输入格式】}

输入包含$n+Q$行。

第$1$行，三个正整数$n,Q,k$。

第$2 \sim n$ 行： 第i行有一个正整数$fa_i$，表示编号为$i$的节点的父亲节点编号。

接下来$Q$行，每行两个正整数$x,y$，表示一次询问。


\subs*{【输出格式】}

输出包含$Q$行，每行一个整数表示答案模$998244353$的结果。

\subs*{【样例输入】}

\begin{verbatim}
2 1 3
1
2 2
\end{verbatim}

\subs*{【样例输出】}

\begin{verbatim}
9
\end{verbatim}

\subs*{【数据规模和约定】}

$n$ 给个$nlog^2n$能过的范围。

$Q$ 和$n$一样大或稍大(同阶)。

$k=1,2,3$ or $k\le 10^9$(?)。

再添加题目描述中涉及到的所有变量的合法约束。

部分分0，n,Q,k都比较小。

部分分1，n比较小。

部分分2，Q比较小。

部分分3，k比较小。

部分分4，k=1,2,3。

部分分5，x从小到大。

部分分6，树其实为一条链。




\newpage





(完)



\en{document}



\s*{Prob} %

\emph{.in/.out/.cpp}

\subs*{【问题描述】}


\subs*{【输入格式】}

\subs*{【输出格式】}

\subs*{【样例输入】}

\begin{verbatim}

\end{verbatim}

\subs*{【样例输出】}

\begin{verbatim}

\end{verbatim}


\subs*{【数据规模和约定】}

对于30\%的数据，满足$n \le 15$。

对于60\%的数据，满足$n \le 1000$。

对于100\%的数据，满足$n \le 100000 ,  1\le a_i \le 10^9$。

\newpage


